group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc/10,
stroke = TRUE, fillOpacity = 0.8,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = TRUE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income (in $1,000s)",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
pal  <- colorNumeric(palette = "Reds", domain =c(0:45))
pal2 <- colorNumeric(palette = "Blues", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "Blues", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:50))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.25,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.25,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc/10,
stroke = TRUE, fillOpacity = 0.8,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = TRUE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income (in $1,000s)",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
pal  <- colorNumeric(palette = "Yellows", domain =c(0:45))
pal2 <- colorNumeric(palette = "Blues", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "Blues", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:50))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.25,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.25,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc/10,
stroke = TRUE, fillOpacity = 0.8,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = TRUE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income (in $1,000s)",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
pal  <- colorNumeric(palette = "Reds", domain =c(0:45))
pal2 <- colorNumeric(palette = "Blues", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "Blues", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:50))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.25,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.25,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc/10,
stroke = TRUE, fillOpacity = 0.8,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = TRUE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income (in $1,000s)",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
z <- leaflet(mydfz, options = leafletOptions(dragging=TRUE,
minZoom=4,
maxZoom=11))%>%
setView(-98.35, 39.5, 4) %>%
addProviderTiles("MapBox", options = providerTileOptions(
id = "mapbox.light",
accessToken = Sys.getenv('MAPBOX_ACCESS_TOKEN')))
summary(mydfz@data)
US2017<- read.csv(file = "HPV Data/HPV vaccine/HPV_vax_by_state.csv", na.strings = c("", "NA"), fileEncoding="UTF-8-BOM") %>%
drop_na(HPV)
US2017
mydfz<- sp::merge(states, US2017 , by="NAME", all=T)
summary(mydfz@data)
mydfz <- mydfz %>%
drop_na(HPV)
palz1  <- colorNumeric(palette = "Blues", domain =c(0:100))
z
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydf$All),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(Percent_uninsured$PCTUI_PTnum),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=palz1,
values = c(0:100))
ZZZ
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(Pmydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=palz1,
values = c(0:100))
ZZZ
palz1  <- colorNumeric(palette = "Reds", domain =c(0:100))
palz2  <- colorNumeric(palette = "Blues", domain =c(0:100))
palz1  <- colorNumeric(palette = "Reds", domain =c(0:100))
palz2  <- colorNumeric(palette = "Blues", domain =c(0:100))
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=palz1,
values = c(0:100))
ZZZ
palz1  <- colorNumeric(palette = "Blues", domain =c(45:100))
palz2  <- colorNumeric(palette = "Blues", domain =c(25:100))
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:100)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomleft",
pal=palz2,
values = c(0:80))
ZZZ
palz1  <- colorBin(palette = "Blues", mydfz$HPV, 4)
palz2  <- colorBin(palette = "Blues", mydfz$HPV.UTD2, 3)
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:100)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomleft",
pal=palz2,
values = c(0:80))
ZZZ
mydfz$HPV.UTD2
mydfz$HPV
mydfz$HPV.UTD
na.rm(mydfz$HPV.UTD2)
newHPV <- na.omit(mydfz$HPV)
newHPV
newHPVUtD <- na.omit(mydfz$HPV.UTD)
palz1  <- colorBin(palette = "Blues", newHPV , 4)
palz2  <- colorBin(palette = "Blues", newHPVUtD, 3)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:100)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomleft",
pal=palz2,
values = c(0:80))
ZZZ
palz1  <- colorNumeric(palette = "Blues", domain =c(45:95))
palz2  <- colorNumeric(palette = "Blues", domain =c(25:80))
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:95)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomright",
pal=palz2,
values = c(25:80))
ZZZ
z <- leaflet(mydfz, options = leafletOptions(dragging=TRUE,
minZoom=5,
maxZoom=11))%>%
setView(-98.35, 39.5, 5) %>%
addProviderTiles("MapBox", options = providerTileOptions(
id = "mapbox.light",
accessToken = Sys.getenv('MAPBOX_ACCESS_TOKEN')))
#Palettes:
palz1  <- colorNumeric(palette = "Blues", domain =c(45:95))
palz2  <- colorNumeric(palette = "Blues", domain =c(25:80))
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:95)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomright",
pal=palz2,
values = c(25:80))
ZZZ
palz1  <- colorNumeric(palette = "Blues", domain =c(45:95))
palz2  <- colorNumeric(palette = "Reds", domain =c(25:80), reverse = TRUE)
summary(mydfz@data)
ZZ <- z %>% addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz1(mydfz$HPV),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine Initiated: ",
mydfz$HPV2, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV 1+") %>%
addPolygons(data = mydfz, weight=1, fillOpacity = 0.25,
color = palz2(mydfz$HPV.UTD),
label = mydfz$NAME,
popup = paste0("Percent HPV vaccine UtD ",
mydfz$HPV.UTD2 , "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "HPV Vaccine UtD") %>%
addLayersControl(overlayGroups = c("HPV 1+", "HPV Vaccine UtD"))
ZZZ <- ZZ %>% addResetMapButton() %>%
addLegend(title = "Vaccination Initiated",
position = "bottomleft",
pal=palz1,
values = c(45:95)) %>%
addLegend(title = "Vaccination UtD",
position = "bottomright",
pal=palz2,
values = c(25:80))
ZZZ
saveWidget(ZZZ, file = "/Users/andywilson1/Documents/GitHub/Olivia-DIA/Output/NIS Teen Vax map.html")
