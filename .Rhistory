position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
Wash_prev
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = TRUE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2)),
radius = Wash_prev$n_positive,
stroke = TRUE, fillOpacity = 0.7,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:20))
MMM
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = FALSE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2)),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.5,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:20))
MMM
Wash_prev <- prev %>%
filter(Longitude_avg >=  lon_min) %>%
filter(Longitude_avg <=  lon_max) %>%
filter(Latitude_avg  >=  lat_min) %>%
filter(Latitude_avg  <=  lat_max) %>%
filter(zip3 != "971")
summary(Wash_prev)
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = FALSE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2)),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.5,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:20))
MMM
?colorNumeric
pal  <- colorNumeric(palette = "RdYlBu", domain =c(0:45))
pal2 <- colorNumeric(palette = "RdYlBu", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "RdYlBu", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:20))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = FALSE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2),
"<br/>",
"n screened = ", myWashIRS$n_screened,
"<br/>",
"n positive = ", myWashIRS$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.5,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:20))
MMM
pal  <- colorNumeric(palette = "RdYlBu", domain =c(0:45))
pal2 <- colorNumeric(palette = "RdYlBu", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "RdYlBu", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:50))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = FALSE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.5,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
saveWidget(MMM, file = "C:/Users/wilso/Documents/GitHub/Olivia-DIA/Output/Prototype Washington map v1.0.html")
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = FALSE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = TRUE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = FALSE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
pal  <- colorNumeric(palette = "RdYlBu", domain =c(0:45))
pal2 <- colorNumeric(palette = "RdYlBu", domain =c(0:140), reverse = TRUE)
pal3 <- colorNumeric(palette = "RdYlBu", domain =c(0:15), reverse = TRUE)
pal4 <- colorNumeric(palette = "Blues", domain =c(1:50))
MM <- m %>% addPolygons(data = mydf, weight=1, fillOpacity = 0.45,
color = pal(mydf$All),
label = mydf$NAME,
popup = paste0("Percent HPV vaccine UtD: ",
mydf$All, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County HPV vaccination") %>%
addPolygons(data = mydf2, weight=1, fillOpacity = 0.45,
color = pal3(Percent_uninsured$PCTUI_PTnum),
label = mydf2$NAME,
popup = paste0("Percent Uninsured: ",
Percent_uninsured$PCTUI_PTnum, "%"),
labelOptions = labelOptions(textOnly = FALSE),
group = "County Uninsured") %>%
addCircleMarkers(lng = myWashIRS$longitude,
lat = myWashIRS$latitude,
label = myWashIRS$PlaceName,
popup = paste("<b>", myWashIRS$PlaceName,"</b>",
"<br/>",
" AVG ADJUSTED GROSS INCOME (IN THOUSANDS OF DOLLARS)     = $", round(myWashIRS$AdjInc,2),
"<br/>",
"zip = ", myWashIRS$zip),
radius = myWashIRS$AdjInc,
stroke = TRUE, fillOpacity = 0.5,
color = pal2(myWashIRS$AdjInc),
group = "IRS tax data by zip",
clusterOptions = markerClusterOptions()) %>%
addCircleMarkers(lng = Wash_prev$Longitude_avg,
lat = Wash_prev$Latitude_avg,
label = Wash_prev$zip3,
popup = paste("<b>", Wash_prev$zip3,"</b>",
"<br/>",
" Positivity rate: ", round(Wash_prev$positivity,2), "%",
"<br/>",
"n screened = ", Wash_prev$n_screened,
"<br/>",
"n positive = ", Wash_prev$n_positive
),
radius = log(Wash_prev$n_positive),
stroke = TRUE, fillOpacity = 0.8,
color = pal4(Wash_prev$positivity),
group = "Positivity by 3-digit zip") %>%
addLayersControl(overlayGroups = c("County HPV vaccination", "IRS tax data by zip", "County Uninsured", "Positivity by 3-digit zip"))
MMM <- MM %>% addResetMapButton() %>%
addLegend(title = "Vaccination rates",
position = "bottomleft",
pal=pal,
values = c(0:45)) %>%
addLegend(title = "Avg annual income",
position = "bottomright",
pal=pal2,
values = c(0:150))%>%
addLegend(title = "Percent uninsured",
position = "topleft",
pal=pal3,
values = c(0:15)) %>%
addLegend(title = "Positivity rate",
position = "topright",
pal=pal4,
values = c(0:50))
MMM
saveWidget(MMM, file = "C:/Users/wilso/Documents/GitHub/Olivia-DIA/Output/Prototype Washington map v1.0.html")
